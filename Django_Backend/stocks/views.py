import requests
from django.http import JsonResponse
from django.contrib.auth import authenticate, login, logout
from django.http import JsonResponse
from django.views.decorators.csrf import csrf_exempt

@csrf_exempt
def login_view(request):
    if request.method == 'POST':
        username = request.POST.get('username')
        password = request.POST.get('password')
        user = authenticate(request, username=username, password=password)
        if user is not None:
            login(request, user)
            return JsonResponse({'message': 'Login successful'})
        else:
            return JsonResponse({'message': 'Invalid username or password'}, status=400)
    else:
        return JsonResponse({'message': 'Method not allowed'}, status=405)

def logout_view(request):
    logout(request)
    return JsonResponse({'message': 'Logout successful'})

# Api rate limit exceeded 

# def fetch_stock_data(request):
#     symbol = request.GET.get('symbol', 'IBM')  # Default to IBM if symbol is not provided
#     interval = request.GET.get('interval', '5min')  # Default interval to 5 minutes
#     api_key = '4R30R8Z3GE1MMWQL'
    
#     url = f"https://www.alphavantage.co/query?function=TIME_SERIES_INTRADAY&symbol={symbol}&interval={interval}&apikey={api_key}"
    
#     response = requests.get(url)
    
#     if response.status_code == 200:
#         data = response.json()
#         return JsonResponse(data)
#     else:
#         return JsonResponse({'error': 'Failed to fetch data'}, status=500)

def send_post_request(request):
    data =  {
    "Meta Data": {
      "1. Information": "Intraday (5min) open, high, low, close prices and volume",
      "2. Symbol": "IBM",
      "3. Last Refreshed": "2024-05-15 19:55:00",
      "4. Interval": "5min",
      "5. Output Size": "Compact",
      "6. Time Zone": "US/Eastern"
    },
    "Time Series (5min)": {
      "2024-05-15 19:55:00": {
        "1. open": "168.8500",
        "2. high": "169.0000",
        "3. low": "168.7600",
        "4. close": "169.0000",
        "5. volume": "215"
      },
      "2024-05-15 19:50:00": {
        "1. open": "168.8400",
        "2. high": "168.9000",
        "3. low": "168.8400",
        "4. close": "168.9000",
        "5. volume": "21"
      },
      "2024-05-15 19:45:00": {
        "1. open": "168.7500",
        "2. high": "168.7600",
        "3. low": "168.7500",
        "4. close": "168.7600",
        "5. volume": "26"
      },
      "2024-05-15 19:40:00": {
        "1. open": "168.7700",
        "2. high": "168.7700",
        "3. low": "168.7500",
        "4. close": "168.7500",
        "5. volume": "25"
      },
      "2024-05-15 19:35:00": {
        "1. open": "168.7700",
        "2. high": "168.7700",
        "3. low": "168.7700",
        "4. close": "168.7700",
        "5. volume": "6"
      },
      "2024-05-15 19:30:00": {
        "1. open": "168.7500",
        "2. high": "169.0000",
        "3. low": "168.7500",
        "4. close": "168.8000",
        "5. volume": "184"
      },
      "2024-05-15 19:25:00": {
        "1. open": "168.8000",
        "2. high": "168.8900",
        "3. low": "168.7600",
        "4. close": "168.7600",
        "5. volume": "206"
      },
      "2024-05-15 19:20:00": {
        "1. open": "168.8000",
        "2. high": "168.8000",
        "3. low": "168.7900",
        "4. close": "168.8000",
        "5. volume": "669"
      },
      "2024-05-15 19:15:00": {
        "1. open": "168.7600",
        "2. high": "168.8000",
        "3. low": "168.7600",
        "4. close": "168.7900",
        "5. volume": "128"
      },
      "2024-05-15 19:10:00": {
        "1. open": "168.7900",
        "2. high": "168.7900",
        "3. low": "168.7900",
        "4. close": "168.7900",
        "5. volume": "2"
      },
      "2024-05-15 19:05:00": {
        "1. open": "168.8000",
        "2. high": "168.8000",
        "3. low": "168.6600",
        "4. close": "168.6600",
        "5. volume": "29"
      },
      "2024-05-15 19:00:00": {
        "1. open": "168.2600",
        "2. high": "168.8000",
        "3. low": "168.2600",
        "4. close": "168.8000",
        "5. volume": "780462"
      },
      "2024-05-15 18:55:00": {
        "1. open": "168.7980",
        "2. high": "168.8000",
        "3. low": "168.6600",
        "4. close": "168.7300",
        "5. volume": "23"
      },
      "2024-05-15 18:50:00": {
        "1. open": "168.8000",
        "2. high": "168.8000",
        "3. low": "168.7900",
        "4. close": "168.8000",
        "5. volume": "14"
      },
      "2024-05-15 18:45:00": {
        "1. open": "168.8000",
        "2. high": "168.8000",
        "3. low": "168.8000",
        "4. close": "168.8000",
        "5. volume": "12"
      },
      "2024-05-15 18:40:00": {
        "1. open": "168.7500",
        "2. high": "168.7900",
        "3. low": "168.7500",
        "4. close": "168.7800",
        "5. volume": "180"
      },
      "2024-05-15 18:35:00": {
        "1. open": "168.7500",
        "2. high": "168.8000",
        "3. low": "168.6600",
        "4. close": "168.6600",
        "5. volume": "47"
      },
      "2024-05-15 18:30:00": {
        "1. open": "168.2600",
        "2. high": "168.8000",
        "3. low": "168.2600",
        "4. close": "168.7600",
        "5. volume": "775501"
      },
      "2024-05-15 18:25:00": {
        "1. open": "168.6600",
        "2. high": "168.8000",
        "3. low": "168.6600",
        "4. close": "168.8000",
        "5. volume": "107"
      },
      "2024-05-15 18:20:00": {
        "1. open": "168.7900",
        "2. high": "168.8400",
        "3. low": "168.7900",
        "4. close": "168.8000",
        "5. volume": "139"
      },
      "2024-05-15 18:15:00": {
        "1. open": "169.0000",
        "2. high": "169.0000",
        "3. low": "169.0000",
        "4. close": "169.0000",
        "5. volume": "20"
      },
      "2024-05-15 18:10:00": {
        "1. open": "168.6600",
        "2. high": "169.0000",
        "3. low": "168.6600",
        "4. close": "169.0000",
        "5. volume": "68"
      },
      "2024-05-15 18:05:00": {
        "1. open": "169.0000",
        "2. high": "169.0000",
        "3. low": "168.7500",
        "4. close": "168.7500",
        "5. volume": "218"
      },
      "2024-05-15 18:00:00": {
        "1. open": "168.8000",
        "2. high": "168.8000",
        "3. low": "168.8000",
        "4. close": "168.8000",
        "5. volume": "1"
      },
      "2024-05-15 17:55:00": {
        "1. open": "168.7500",
        "2. high": "168.7500",
        "3. low": "168.7500",
        "4. close": "168.7500",
        "5. volume": "1"
      },
      "2024-05-15 17:50:00": {
        "1. open": "168.7700",
        "2. high": "169.0000",
        "3. low": "168.7500",
        "4. close": "169.0000",
        "5. volume": "60"
      },
      "2024-05-15 17:45:00": {
        "1. open": "168.8100",
        "2. high": "168.8100",
        "3. low": "168.7700",
        "4. close": "168.7700",
        "5. volume": "40"
      },
      "2024-05-15 17:40:00": {
        "1. open": "169.0000",
        "2. high": "169.0000",
        "3. low": "168.7000",
        "4. close": "168.7200",
        "5. volume": "12"
      },
      "2024-05-15 17:35:00": {
        "1. open": "168.6600",
        "2. high": "168.8200",
        "3. low": "168.6600",
        "4. close": "168.8200",
        "5. volume": "34"
      },
      "2024-05-15 17:30:00": {
        "1. open": "169.0000",
        "2. high": "169.0000",
        "3. low": "168.6500",
        "4. close": "168.8500",
        "5. volume": "339"
      },
      "2024-05-15 17:25:00": {
        "1. open": "169.0000",
        "2. high": "169.0000",
        "3. low": "168.9500",
        "4. close": "168.9700",
        "5. volume": "60"
      },
      "2024-05-15 17:20:00": {
        "1. open": "168.6600",
        "2. high": "169.0000",
        "3. low": "168.6500",
        "4. close": "169.0000",
        "5. volume": "168"
      },
      "2024-05-15 17:15:00": {
        "1. open": "168.9900",
        "2. high": "168.9900",
        "3. low": "168.9000",
        "4. close": "168.9000",
        "5. volume": "1390"
      },
      "2024-05-15 17:10:00": {
        "1. open": "168.9700",
        "2. high": "168.9900",
        "3. low": "168.9000",
        "4. close": "168.9900",
        "5. volume": "256"
      },
      "2024-05-15 17:05:00": {
        "1. open": "168.9500",
        "2. high": "168.9900",
        "3. low": "168.9500",
        "4. close": "168.9900",
        "5. volume": "66"
      },
      "2024-05-15 17:00:00": {
        "1. open": "168.8400",
        "2. high": "168.9500",
        "3. low": "168.6500",
        "4. close": "168.8000",
        "5. volume": "450"
      },
      "2024-05-15 16:55:00": {
        "1. open": "168.6500",
        "2. high": "168.9500",
        "3. low": "168.6500",
        "4. close": "168.8400",
        "5. volume": "373"
      },
      "2024-05-15 16:50:00": {
        "1. open": "168.8000",
        "2. high": "168.9500",
        "3. low": "168.5900",
        "4. close": "168.6000",
        "5. volume": "616"
      },
      "2024-05-15 16:45:00": {
        "1. open": "168.8000",
        "2. high": "168.9900",
        "3. low": "168.5900",
        "4. close": "168.9500",
        "5. volume": "618"
      },
      "2024-05-15 16:40:00": {
        "1. open": "168.3500",
        "2. high": "168.7800",
        "3. low": "168.3500",
        "4. close": "168.5900",
        "5. volume": "2640"
      },
      "2024-05-15 16:35:00": {
        "1. open": "168.0000",
        "2. high": "168.3500",
        "3. low": "168.0000",
        "4. close": "168.3500",
        "5. volume": "752"
      },
      "2024-05-15 16:30:00": {
        "1. open": "168.1000",
        "2. high": "168.3500",
        "3. low": "168.0000",
        "4. close": "168.3500",
        "5. volume": "616"
      },
      "2024-05-15 16:25:00": {
        "1. open": "168.1100",
        "2. high": "168.2000",
        "3. low": "167.9000",
        "4. close": "167.9000",
        "5. volume": "107"
      },
      "2024-05-15 16:20:00": {
        "1. open": "168.2600",
        "2. high": "168.2600",
        "3. low": "168.2500",
        "4. close": "168.2600",
        "5. volume": "963"
      },
      "2024-05-15 16:15:00": {
        "1. open": "168.2600",
        "2. high": "168.2600",
        "3. low": "167.9000",
        "4. close": "167.9000",
        "5. volume": "115"
      },
      "2024-05-15 16:10:00": {
        "1. open": "168.2600",
        "2. high": "168.2600",
        "3. low": "167.6000",
        "4. close": "167.6000",
        "5. volume": "983063"
      },
      "2024-05-15 16:05:00": {
        "1. open": "168.2600",
        "2. high": "168.2600",
        "3. low": "168.0000",
        "4. close": "168.2600",
        "5. volume": "11171"
      },
      "2024-05-15 16:00:00": {
        "1. open": "168.2600",
        "2. high": "168.3500",
        "3. low": "167.7000",
        "4. close": "168.3460",
        "5. volume": "1648986"
      },
      "2024-05-15 15:55:00": {
        "1. open": "168.0750",
        "2. high": "168.3000",
        "3. low": "168.0550",
        "4. close": "168.2600",
        "5. volume": "305550"
      },
      "2024-05-15 15:50:00": {
        "1. open": "168.1000",
        "2. high": "168.1000",
        "3. low": "167.9100",
        "4. close": "168.0700",
        "5. volume": "133973"
      },
      "2024-05-15 15:45:00": {
        "1. open": "168.2400",
        "2. high": "168.2600",
        "3. low": "168.0800",
        "4. close": "168.1200",
        "5. volume": "102583"
      },
      "2024-05-15 15:40:00": {
        "1. open": "168.2110",
        "2. high": "168.3200",
        "3. low": "168.2100",
        "4. close": "168.2400",
        "5. volume": "54188"
      },
      "2024-05-15 15:35:00": {
        "1. open": "168.2400",
        "2. high": "168.3500",
        "3. low": "168.1500",
        "4. close": "168.2200",
        "5. volume": "49148"
      },
      "2024-05-15 15:30:00": {
        "1. open": "168.1800",
        "2. high": "168.2500",
        "3. low": "168.1100",
        "4. close": "168.2320",
        "5. volume": "41617"
      },
      "2024-05-15 15:25:00": {
        "1. open": "168.0150",
        "2. high": "168.2300",
        "3. low": "168.0000",
        "4. close": "168.1900",
        "5. volume": "39629"
      },
      "2024-05-15 15:20:00": {
        "1. open": "167.9400",
        "2. high": "168.0300",
        "3. low": "167.8700",
        "4. close": "168.0300",
        "5. volume": "36843"
      },
      "2024-05-15 15:15:00": {
        "1. open": "167.9500",
        "2. high": "168.0050",
        "3. low": "167.8700",
        "4. close": "167.9600",
        "5. volume": "33596"
      },
      "2024-05-15 15:10:00": {
        "1. open": "167.9400",
        "2. high": "168.0200",
        "3. low": "167.9000",
        "4. close": "167.9500",
        "5. volume": "46915"
      },
      "2024-05-15 15:05:00": {
        "1. open": "167.9460",
        "2. high": "167.9900",
        "3. low": "167.8900",
        "4. close": "167.9450",
        "5. volume": "27821"
      },
      "2024-05-15 15:00:00": {
        "1. open": "167.8900",
        "2. high": "167.9800",
        "3. low": "167.8500",
        "4. close": "167.9450",
        "5. volume": "30985"
      },
      "2024-05-15 14:55:00": {
        "1. open": "167.9350",
        "2. high": "167.9400",
        "3. low": "167.8000",
        "4. close": "167.8910",
        "5. volume": "34765"
      },
      "2024-05-15 14:50:00": {
        "1. open": "167.8400",
        "2. high": "167.9800",
        "3. low": "167.8200",
        "4. close": "167.9200",
        "5. volume": "19803"
      },
      "2024-05-15 14:45:00": {
        "1. open": "167.9300",
        "2. high": "167.9700",
        "3. low": "167.8300",
        "4. close": "167.8300",
        "5. volume": "21940"
      },
      "2024-05-15 14:40:00": {
        "1. open": "167.9100",
        "2. high": "167.9900",
        "3. low": "167.8000",
        "4. close": "167.9320",
        "5. volume": "31184"
      },
      "2024-05-15 14:35:00": {
        "1. open": "167.8400",
        "2. high": "167.9400",
        "3. low": "167.8100",
        "4. close": "167.9400",
        "5. volume": "15392"
      },
      "2024-05-15 14:30:00": {
        "1. open": "167.9450",
        "2. high": "167.9600",
        "3. low": "167.8500",
        "4. close": "167.8500",
        "5. volume": "20764"
      },
      "2024-05-15 14:25:00": {
        "1. open": "167.7900",
        "2. high": "167.9500",
        "3. low": "167.7750",
        "4. close": "167.9500",
        "5. volume": "25045"
      },
      "2024-05-15 14:20:00": {
        "1. open": "167.7500",
        "2. high": "167.8050",
        "3. low": "167.6700",
        "4. close": "167.7900",
        "5. volume": "20625"
      },
      "2024-05-15 14:15:00": {
        "1. open": "167.9200",
        "2. high": "167.9200",
        "3. low": "167.6300",
        "4. close": "167.7400",
        "5. volume": "24055"
      },
      "2024-05-15 14:10:00": {
        "1. open": "167.8300",
        "2. high": "167.9400",
        "3. low": "167.7500",
        "4. close": "167.9400",
        "5. volume": "26391"
      },
      "2024-05-15 14:05:00": {
        "1. open": "167.7800",
        "2. high": "167.8600",
        "3. low": "167.7730",
        "4. close": "167.8300",
        "5. volume": "19726"
      },
      "2024-05-15 14:00:00": {
        "1. open": "167.7650",
        "2. high": "167.7800",
        "3. low": "167.6900",
        "4. close": "167.7800",
        "5. volume": "21360"
      },
      "2024-05-15 13:55:00": {
        "1. open": "167.8100",
        "2. high": "167.8200",
        "3. low": "167.6910",
        "4. close": "167.7650",
        "5. volume": "17024"
      },
      "2024-05-15 13:50:00": {
        "1. open": "167.7600",
        "2. high": "167.8200",
        "3. low": "167.6900",
        "4. close": "167.8200",
        "5. volume": "20393"
      },
      "2024-05-15 13:45:00": {
        "1. open": "167.8400",
        "2. high": "167.8400",
        "3. low": "167.6400",
        "4. close": "167.7450",
        "5. volume": "22506"
      },
      "2024-05-15 13:40:00": {
        "1. open": "167.7300",
        "2. high": "167.8900",
        "3. low": "167.7300",
        "4. close": "167.8200",
        "5. volume": "21151"
      },
      "2024-05-15 13:35:00": {
        "1. open": "167.8400",
        "2. high": "167.8400",
        "3. low": "167.6900",
        "4. close": "167.7500",
        "5. volume": "19434"
      },
      "2024-05-15 13:30:00": {
        "1. open": "167.8100",
        "2. high": "167.8300",
        "3. low": "167.6900",
        "4. close": "167.7900",
        "5. volume": "21013"
      },
      "2024-05-15 13:25:00": {
        "1. open": "167.9500",
        "2. high": "167.9500",
        "3. low": "167.8300",
        "4. close": "167.8300",
        "5. volume": "23728"
      },
      "2024-05-15 13:20:00": {
        "1. open": "167.9430",
        "2. high": "168.0000",
        "3. low": "167.8900",
        "4. close": "167.9300",
        "5. volume": "19040"
      },
      "2024-05-15 13:15:00": {
        "1. open": "167.9700",
        "2. high": "168.0400",
        "3. low": "167.8900",
        "4. close": "167.8900",
        "5. volume": "29699"
      },
      "2024-05-15 13:10:00": {
        "1. open": "167.7600",
        "2. high": "168.0000",
        "3. low": "167.7340",
        "4. close": "167.9310",
        "5. volume": "17732"
      },
      "2024-05-15 13:05:00": {
        "1. open": "167.9700",
        "2. high": "168.0300",
        "3. low": "167.7600",
        "4. close": "167.7850",
        "5. volume": "31812"
      },
      "2024-05-15 13:00:00": {
        "1. open": "167.9250",
        "2. high": "168.0300",
        "3. low": "167.8700",
        "4. close": "167.9600",
        "5. volume": "44342"
      },
      "2024-05-15 12:55:00": {
        "1. open": "167.8600",
        "2. high": "167.9700",
        "3. low": "167.8550",
        "4. close": "167.9100",
        "5. volume": "33309"
      },
      "2024-05-15 12:50:00": {
        "1. open": "167.9050",
        "2. high": "167.9300",
        "3. low": "167.7900",
        "4. close": "167.8710",
        "5. volume": "26559"
      },
      "2024-05-15 12:45:00": {
        "1. open": "167.8000",
        "2. high": "167.9900",
        "3. low": "167.7700",
        "4. close": "167.8930",
        "5. volume": "38281"
      },
      "2024-05-15 12:40:00": {
        "1. open": "167.7000",
        "2. high": "167.8030",
        "3. low": "167.6700",
        "4. close": "167.8000",
        "5. volume": "53181"
      },
      "2024-05-15 12:35:00": {
        "1. open": "167.8100",
        "2. high": "167.9290",
        "3. low": "167.6400",
        "4. close": "167.6600",
        "5. volume": "69970"
      },
      "2024-05-15 12:30:00": {
        "1. open": "167.8100",
        "2. high": "167.8600",
        "3. low": "167.6900",
        "4. close": "167.8050",
        "5. volume": "55896"
      },
      "2024-05-15 12:25:00": {
        "1. open": "167.8950",
        "2. high": "167.9150",
        "3. low": "167.7600",
        "4. close": "167.8600",
        "5. volume": "22990"
      },
      "2024-05-15 12:20:00": {
        "1. open": "168.1130",
        "2. high": "168.1130",
        "3. low": "167.9100",
        "4. close": "167.9100",
        "5. volume": "39222"
      },
      "2024-05-15 12:15:00": {
        "1. open": "168.2500",
        "2. high": "168.2510",
        "3. low": "168.0500",
        "4. close": "168.1200",
        "5. volume": "29113"
      },
      "2024-05-15 12:10:00": {
        "1. open": "168.0310",
        "2. high": "168.2800",
        "3. low": "168.0310",
        "4. close": "168.2800",
        "5. volume": "46807"
      },
      "2024-05-15 12:05:00": {
        "1. open": "168.0950",
        "2. high": "168.1100",
        "3. low": "167.9000",
        "4. close": "168.0300",
        "5. volume": "26260"
      },
      "2024-05-15 12:00:00": {
        "1. open": "168.1200",
        "2. high": "168.1500",
        "3. low": "168.0200",
        "4. close": "168.0900",
        "5. volume": "32654"
      },
      "2024-05-15 11:55:00": {
        "1. open": "168.0650",
        "2. high": "168.1400",
        "3. low": "168.0310",
        "4. close": "168.1230",
        "5. volume": "35374"
      },
      "2024-05-15 11:50:00": {
        "1. open": "168.0300",
        "2. high": "168.1500",
        "3. low": "168.0100",
        "4. close": "168.0600",
        "5. volume": "38140"
      },
      "2024-05-15 11:45:00": {
        "1. open": "168.0330",
        "2. high": "168.1050",
        "3. low": "168.0200",
        "4. close": "168.0500",
        "5. volume": "20060"
      },
      "2024-05-15 11:40:00": {
        "1. open": "168.0600",
        "2. high": "168.1450",
        "3. low": "168.0200",
        "4. close": "168.0200",
        "5. volume": "22482"
      }
    }
  }
    return JsonResponse(data)
